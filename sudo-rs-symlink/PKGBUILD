# Maintainer: SovietReimu1228 <reimu@hakurei.win>

pkgname=sudo-rs-symlink
pkgver=0.2.12
pkgrel=2
pkgdesc='(Avoid if app supports PATH) swap sudo with -rs'
arch=(any)
url="https://github.com/trifectatechfoundation/sudo-rs"
license=('Apache-2.0 AND MIT')
depends=(sudo-rs)
provides=(sudo)
conflicts=(sudo)
source=("https://gitlab.archlinux.org/archlinux/packaging/packages/sudo/-/raw/main/sudo.pam"
sudoers-rs)
sha512sums=('SKIP'
            'a80bc9cc19093c042017618be972b57c610baae3b8948470f41f52d54e07c3d5c2447fbcea5695b9c03848a17b1b90925a83998968c9cf0f2e610a7109bd2bb5')
package (){
  install -Dm0644 sudo.pam "$pkgdir"/etc/pam.d/sudo
  ln -sf /etc/pam.d/sudo "$pkgdir"/etc/pam.d/sudo-i
  install -Dm0440 sudoers-rs "$pkgdir"/etc/sudoers-rs
  install -dm0750 "$pkgdir"/etc/sudoers.d # remove warning
  install -d "$pkgdir"/usr/{bin,share/man/man8}
  ln -sf /usr/bin/visudo-rs "$pkgdir"/usr/bin/visudo
  ln -sf /usr/bin/sudo-rs "$pkgdir"/usr/bin/sudo
  ln -sf /usr/share/man/man8/sudo-rs.8.gz "$pkgdir"/usr/share/man/man8/sudo.8.gz
  ln -sf /usr/share/man/man8/visudo-rs.8.gz "$pkgdir"/usr/share/man/man8/visudo.8.gz
  echo 'Avoid using this if your application supports config or PATH'
}
